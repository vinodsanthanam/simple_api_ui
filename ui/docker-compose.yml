version: '2'

services:
  ui:
    image: vinodsanthanam/ui 
    ports:
      - "5001"
    environment:
      - ui_port=5001
      - ui_environment=docker-swarm-dev
    networks:
      - back-tier
  ui_lb:
    image: vinodsanthanam/lb
    ports:
      - "80:80"
    environment:
      - constraint:node==ui-master
      - APP_NAME=ui
      - CONSUL_URL=${UI_KV_IP}:8500
    depends_on:
      - ui
    networks:
      - front-tier
networks:
  front-tier:
    driver: overlay
  back-tier:
    driver: overlay
